<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Theme Made By www.w3schools.com -->
    <title>ElectroBills</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="./assets/bootstrap-3.4.1-dist/css/bootstrap.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Montserrat"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Lato"
      rel="stylesheet"
      type="text/css"
    />
    <script src="./assets/jquery/jquery-3.5.1.js"></script>
    <script src="./assets/bootstrap-3.4.1-dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="src/css/index.css" />
    <link rel="stylesheet" href="src/css/login-modal.css" />
  </head>
  <body id="myPage" data-spy="scroll" data-target=".navbar" data-offset="60">
    <!-- login modal -->
    <div id="login-modal" class="modal">
      <form class="modal-content animate">
        <div class="imgcontainer">
          <span
            class="close"
            id="closeBtn"
            title="Close Modal"
            data-dismiss="modal"
            >&times;</span
          >
          <img src="./assets/img/bill-icon.png" alt="Avatar" class="avatar" />
        </div>

        <div class="content-container">
          <label for="uname"><b>Tài khoản</b></label>
          <input
            id="username"
            type="text"
            placeholder="Enter Username"
            name="uname"
            required
          />

          <label for="psw"><b>Mật khẩu</b></label>
          <input
            id="password"
            type="password"
            placeholder="Enter Password"
            name="psw"
            required
          />
          <p id="login-failed">Sai tên đăng nhập hoặc mật khẩu</p>
          <button type="button" id="btn-login">Đăng nhập</button>
        </div>
      </form>
    </div>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button
            type="button"
            class="navbar-toggle"
            data-toggle="collapse"
            data-target="#myNavbar"
          >
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#myPage">ElectroBills</a>
        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#about">VỀ CHÚNG TÔI</a></li>
            <li><a href="#services">DỊCH VỤ</a></li>
            <li><a href="#rank">XẾP HẠNG</a></li>
            <li><a href="#pricing">GÓI SẢN PHẨM</a></li>
            <li><a href="#contact">LIÊN HỆ</a></li>
            <li><a class="space"></a></li>
            <li><a class="space"></a></li>
            <li>
              <a
                style="cursor: pointer"
                data-toggle="modal"
                data-target="#login-modal"
              >
                ĐĂNG NHẬP&nbsp;&nbsp;<i class="fas fa-sign-in-alt"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="jumbotron text-center">
      <h1>ElectroBills</h1>
      <p>Thúc đẩy sự tăng trưởng cho doanh nghiệp của bạn</p>
      <form>
        <div class="input-group">
          <input type="email" class="form-control" size="50" placeholder="Địa
          chỉ Email"" required>
          <div class="input-group-btn">
            <button type="button" class="btn btn-danger">Tư vấn cho tôi</button>
          </div>
        </div>
      </form>
    </div>

    <!-- Container (About Section) -->
    <div id="about" class="container-fluid">
      <div class="row">
        <div class="col-sm-8">
          <h2>Về ElectroBills</h2>
          <br />
          <h4>Phần mềm hóa đơn điện tử hàng đầu Việt Nam</h4>
          <br />
          <p>
            Với đội ngũ phát triển giàu kinh nghiệm, chúng tôi luôn nỗ lực để
            đáp ứng nhu cầu sử dụng của mọi khách hàng. Bạn sẽ bất ngờ trước sự
            tăng trưởng doanh thu mà hóa đơn điện tử của chúng tôi mang lại!
          </p>
          <br /><button class="btn btn-default btn-lg">
            <a href="#pricing">Mua ngay</a>
          </button>
        </div>
        <div class="col-sm-4">
          <span class="glyphicon glyphicon-signal logo"></span>
        </div>
      </div>
    </div>

    <div class="container-fluid bg-grey">
      <div class="row">
        <div class="col-sm-4">
          <span class="glyphicon glyphicon-globe logo slideanim"></span>
        </div>
        <div class="col-sm-8">
          <h2>Giá trị cốt lõi</h2>
          <br />
          <h4>
            <strong>SỨ MỆNH:</strong> Sứ mệnh của chúng tôi là đưa các doanh
            nghiệp đến với một cấp bậc mới trong kinh doanh.
          </h4>
          <br />
          <p>
            <strong>TẦM NHÌN:</strong> Tầm nhìn của chúng tôi là giúp tất cả
            doanh nghiệp chuyển đổi hóa đơn giấy sang hóa đơn điện tử, theo quy
            định tại Điều 10, Nghị định 119/2018/NĐ-CP
          </p>
        </div>
      </div>
    </div>

    <!-- Container (Services Section) -->
    <div id="services" class="container-fluid text-center">
      <h2>DỊCH VỤ</h2>
      <h4>Những gì chúng tôi cung cấp</h4>
      <br />
      <div class="row slideanim">
        <div class="col-sm-4">
          <span class="glyphicon glyphicon-envelope logo-small"></span>
          <h4>EMAIL</h4>
          <p>Tích hợp email trong hệ thống</p>
        </div>
        <div class="col-sm-4">
          <span class="glyphicon glyphicon-search logo-small"></span>
          <h4>TÌM KIẾM</h4>
          <p>Hệ thống tìm kiếm tối ưu, giảm thời gian thao tác</p>
        </div>
        <div class="col-sm-4">
          <span class="glyphicon glyphicon-signal logo-small"></span>
          <h4>THỐNG KÊ DOANH THU</h4>
          <p>Chính xác, tin cậy</p>
        </div>
      </div>
      <br /><br />
      <div class="row slideanim">
        <div class="col-sm-4">
          <span class="glyphicon glyphicon-plus-sign logo-small"></span>
          <h4>TÍCH HỢP PHẦN MỀM BÊN THỨ 3</h4>
          <p>
            Tích hợp phần mềm bên thứ 3 giúp bạn thao tác thuận tiện, tiết kiệm
            thời gian
          </p>
        </div>
        <div class="col-sm-4">
          <span class="glyphicon glyphicon-thumbs-up logo-small"></span>
          <h4>KHÁCH HÀNG ĐÁNH GIÁ</h4>
          <p>
            Giúp bạn thu thập đánh giá của khách hàng để cải thiện doanh nghiệp
            của mình
          </p>
        </div>
        <div class="col-sm-4">
          <span class="glyphicon glyphicon-comment logo-small"></span>
          <h4 style="color: #303030">TƯ VẤN TRỰC TUYẾN</h4>
          <p>Tích hợp tính tăng nhắn tin trực tiếp với khách hàng</p>
        </div>
      </div>
    </div>

    <!-- Container (Portfolio Section) -->
    <div id="rank" class="container-fluid text-center bg-grey">
      <h2>Xếp hạng</h2>
      <br />
      <h4>Top khách hàng mua nhiều nhất</h4>
      <div class="row text-center slideanim" id="rank-section">
        
      </div>
      <br />
    </div>

    <!-- Container (Pricing Section) -->
    <div id="pricing" class="container-fluid">
      <div class="text-center">
        <h2>Gói sản phẩm</h2>
        <h4>Chọn một gói sản phẩm phù hợp với sản phẩm của bạn</h4>
      </div>
      <div class="row slideanim">
        <div class="col-sm-4 col-xs-12">
          <div class="panel panel-default text-center">
            <div class="panel-heading">
              <h1>Gói cơ bản</h1>
            </div>
            <div class="panel-body">
              <p><strong>Thống kê doanh thu</strong></p>
              <p><strong>Nhắn tin với khách hàng</strong></p>
              <p><strong>&nbsp;</strong></p>
              <p><strong>&nbsp;</strong></p>
            </div>
            <div class="panel-footer">
              <h3>119.000</h3>
              <h4>1 tháng</h4>
              <button class="btn btn-lg">Mua</button>
            </div>
          </div>
        </div>
        <div class="col-sm-4 col-xs-12">
          <div class="panel panel-default text-center">
            <div class="panel-heading">
              <h1>Pro</h1>
            </div>
            <div class="panel-body">
              <p><strong>Thống kê doanh thu</strong></p>
              <p><strong>Nhắn tin với khách hàng</strong></p>
              <p><strong>Tìm kiếm nhanh</strong></p>
              <p><strong>Tích hợp phần mềm thứ 3</strong></p>
            </div>
            <div class="panel-footer">
              <h3>200.000</h3>
              <h4>1 tháng</h4>
              <button class="btn btn-lg">Mua</button>
            </div>
          </div>
        </div>
        <div class="col-sm-4 col-xs-12">
          <div class="panel panel-default text-center">
            <div class="panel-heading">
              <h1>Gói cao cấp</h1>
            </div>
            <div class="panel-body">
              <p><strong>Đầy đủ tất cả chức năng</strong></p>
              <p><strong>&nbsp;</strong></p>
              <p><strong>&nbsp;</strong></p>
              <p><strong>&nbsp;</strong></p>
            </div>
            <div class="panel-footer">
              <h3>350.000</h3>
              <h4>1 tháng</h4>
              <button class="btn btn-lg">Mua</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Container (Contact Section) -->
    <div id="contact" class="container-fluid bg-grey">
      <h2 class="text-center">LIÊN HỆ</h2>
      <div class="row">
        <div class="col-sm-5">
          <p>Chúng tôi sẽ phản hồi cho bạn trong vòng 24 giờ.</p>
          <p>
            <span class="glyphicon glyphicon-map-marker"></span> Hà Nội, Việt
            Nam
          </p>
          <p><span class="glyphicon glyphicon-phone"></span> +84 963 563 674</p>
          <p>
            <span class="glyphicon glyphicon-envelope"></span>
            khuongitptit@gmail.com
          </p>
        </div>
        <div class="col-sm-7 slideanim">
          <div class="row">
            <!-- <div class="col-sm-6 form-group">
              <input
                class="form-control"
                id="name"
                name="name"
                placeholder="Tên"
                type="text"
                required
              />
            </div> -->
            <div class="col-sm-12 form-group">
              <input
                class="form-control"
                id="email"
                name="email"
                placeholder="Email"
                type="email"
                required
              />
            </div>
          </div>
          <textarea
            class="form-control"
            id="comments"
            name="comments"
            placeholder="Lời nhắn"
            rows="5"
          ></textarea
          ><br />
          <div class="row">
            <div class="col-sm-12 form-group">
              <button class="btn btn-default pull-right" type="button" id="post-comment">
                Gửi
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- notification add comment successful -->
    <div class="alert alert-warning alert-dismissible fade show" role="alert">
      <strong>Holy guacamole!</strong> You should check in on some of those fields below.
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>

    <!-- Image of location/map -->
    <img
      src="/assets/img/earth.jpg"
      class="w3-image w3-greyscale-min"
      style="width: 100%"
    />

    <footer class="container-fluid text-center">
      <a href="#myPage" title="Lên đầu trang">
        <span class="glyphicon glyphicon-chevron-up"></span>
      </a>
      <p>
        Powered by
        <a href="https://github.com/khuongitptit" target="_blank"
          >khuongitptit</a
        >
      </p>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.20/lodash.min.js"></script>
    <script src="./src/js/stat.js"></script>
    <script>
      $(document).ready(function () {
        $("#login-failed").css({ display: "none" });
        $(".navbar a, footer a[href='#myPage']").on("click", function (event) {
          if (this.hash !== "") {
            event.preventDefault();
            var hash = this.hash;
            $("html, body").animate(
              {
                scrollTop: $(hash).offset().top,
              },
              900,
              function () {
                window.location.hash = hash;
              }
            );
          }
        });
        $(window).scroll(function () {
          $(".slideanim").each(function () {
            var pos = $(this).offset().top;
            var winTop = $(window).scrollTop();
            if (pos < winTop + 600) {
              $(this).addClass("slide");
            }
          });
        });
        $("#btn-login").on("click", (e) => {
          e.preventDefault();
          let username = $("#username").val();
          let password = $("#password").val();
          $.ajax({
            type: "POST",
            url: "src/php/login.php",
            data: { username, password },
            success: (res) => {
              const userData = JSON.parse(res);
              if (_.has(userData, "id")) {
                localStorage.setItem("userData", JSON.stringify(userData));
                location.replace("/admin.html");
              }
              if (!_.get(userData, "success")) {
                $("#login-failed").css({ display: "inline" });
              }
            },
            error: (err) => {
              console.log(",,", err);
            },
          });
        });
        const timer = setInterval(() => {
          $.ajax({
            type: "GET",
            url: "src/php/customer.php",
            data: { action: "STAT_CUSTOMER" },
            success: (res) => {
              const statData = JSON.parse(res);
              const statProcessed = _(statData)
                .groupBy("id")
                .map((item, id) => ({
                  customerName: _.head(item).name,
                  customerAvatarURL: _.head(item).avatarURL,
                  total: _.sumBy(item, "price"),
                }))
                .value();

              const finalData = _.take(
                _.orderBy(statProcessed, ["total"], ["desc"]),
                3
              );
              $("#rank-section").empty();
              finalData.map((customer, index) => {
                const { customerName, customerAvatarURL, total } = customer;
                const item = $(`
                  <div class="col-sm-4">
                    <div class="thumbnail">
                      <h6 class="top">TOP: ${index+1}</h6>
                      <img src=${customerAvatarURL} alt=${customerName} width="400" height="300" />
                      <p>Tổng số: ${total}</p>
                      <h6><strong>${customerName}</strong></h6>
                    </div>
                  </div>
                `);
                $("#rank-section").append(item);
              });
            },
            error: (err) => {
              console.log("err", err);
            },
          });
        }, 5000);
        $("#post-comment").on("click",()=>{
          const email = $("#email").val();
          const comment = $("#comments").val();
          $.ajax({
            type: "POST",
            url: "src/php/comment.php",
            data: { action: "ADD", email, comment },
            success: (res) => {
              if(_.get(JSON.parse(res),'success')){
                $("#email").val('');
                $("#comments").val('');
                alert("Bình luận của bạn đã được gửi đi");
              }
            },
            error: (err) => {
              console.log("err", err);
            },
          });
        })
      });
    </script>
  </body>
</html>
